{"version":3,"names":["_interopRequireDefault","require","_defineProperty2","_classCallCheck2","_createClass2","_get2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","default","getOwnPropertyDescriptors","defineProperties","defineProperty","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","sham","Proxy","Boolean","prototype","valueOf","call","e","flattenStyle","NativeAnimatedHelper","AnimatedNode","AnimatedTransform","AnimatedWithChildren","AnimatedStyle","_AnimatedWithChildren","_super","style","_this","transform","_style","value","_walkStyleAndGetValues","initialStyle","updatedStyle","__isNative","__getValue","hasOwnProperty","Array","isArray","_walkStyleAndGetAnimatedValues","__getAnimatedValue","__attach","__addChild","__detach","__removeChild","__makeNative","platformConfig","__getNativeConfig","styleConfig","styleKey","__getPlatformConfig","__getNativeTag","validateStyles","type","module","exports"],"sources":["AnimatedStyle.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n * @format\n */\n\n'use strict';\n\nimport type {PlatformConfig} from '../AnimatedPlatformConfig';\n\nconst flattenStyle = require('../../StyleSheet/flattenStyle');\nconst NativeAnimatedHelper = require('../NativeAnimatedHelper');\nconst AnimatedNode = require('./AnimatedNode');\nconst AnimatedTransform = require('./AnimatedTransform');\nconst AnimatedWithChildren = require('./AnimatedWithChildren');\n\nclass AnimatedStyle extends AnimatedWithChildren {\n  _style: Object;\n\n  constructor(style: any) {\n    super();\n    style = flattenStyle(style) || ({}: {[string]: any});\n    if (style.transform) {\n      style = {\n        ...style,\n        transform: new AnimatedTransform(style.transform),\n      };\n    }\n    this._style = style;\n  }\n\n  // Recursively get values for nested styles (like iOS's shadowOffset)\n  _walkStyleAndGetValues(style: any, initialStyle: ?Object) {\n    const updatedStyle: {[string]: any | {...}} = {};\n    for (const key in style) {\n      const value = style[key];\n      if (value instanceof AnimatedNode) {\n        // During initial render we want to use the initial value of both natively and non-natively\n        // driven nodes. On subsequent renders, we cannot use the value of natively driven nodes\n        // as they may not be up to date, so we use the initial value to ensure that values of\n        // native animated nodes do not impact rerenders.\n        if (!initialStyle || !value.__isNative) {\n          updatedStyle[key] = value.__getValue();\n        } else if (initialStyle.hasOwnProperty(key)) {\n          updatedStyle[key] = initialStyle[key];\n        }\n      } else if (value && !Array.isArray(value) && typeof value === 'object') {\n        // Support animating nested values (for example: shadowOffset.height)\n        updatedStyle[key] = this._walkStyleAndGetValues(value, initialStyle);\n      } else {\n        updatedStyle[key] = value;\n      }\n    }\n    return updatedStyle;\n  }\n\n  __getValue(initialStyle: ?Object): Object {\n    return this._walkStyleAndGetValues(this._style, initialStyle);\n  }\n\n  // Recursively get animated values for nested styles (like iOS's shadowOffset)\n  _walkStyleAndGetAnimatedValues(style: any) {\n    const updatedStyle: {[string]: any | {...}} = {};\n    for (const key in style) {\n      const value = style[key];\n      if (value instanceof AnimatedNode) {\n        updatedStyle[key] = value.__getAnimatedValue();\n      } else if (value && !Array.isArray(value) && typeof value === 'object') {\n        // Support animating nested values (for example: shadowOffset.height)\n        updatedStyle[key] = this._walkStyleAndGetAnimatedValues(value);\n      }\n    }\n    return updatedStyle;\n  }\n\n  __getAnimatedValue(): Object {\n    return this._walkStyleAndGetAnimatedValues(this._style);\n  }\n\n  __attach(): void {\n    for (const key in this._style) {\n      const value = this._style[key];\n      if (value instanceof AnimatedNode) {\n        value.__addChild(this);\n      }\n    }\n  }\n\n  __detach(): void {\n    for (const key in this._style) {\n      const value = this._style[key];\n      if (value instanceof AnimatedNode) {\n        value.__removeChild(this);\n      }\n    }\n    super.__detach();\n  }\n\n  __makeNative(platformConfig: ?PlatformConfig) {\n    for (const key in this._style) {\n      const value = this._style[key];\n      if (value instanceof AnimatedNode) {\n        value.__makeNative(platformConfig);\n      }\n    }\n    super.__makeNative(platformConfig);\n  }\n\n  __getNativeConfig(): Object {\n    const styleConfig: {[string]: ?number} = {};\n    for (const styleKey in this._style) {\n      if (this._style[styleKey] instanceof AnimatedNode) {\n        const style = this._style[styleKey];\n        style.__makeNative(this.__getPlatformConfig());\n        styleConfig[styleKey] = style.__getNativeTag();\n      }\n      // Non-animated styles are set using `setNativeProps`, no need\n      // to pass those as a part of the node config\n    }\n    NativeAnimatedHelper.validateStyles(styleConfig);\n    return {\n      type: 'style',\n      style: styleConfig,\n    };\n  }\n}\n\nmodule.exports = AnimatedStyle;\n"],"mappings":"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"}